{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/BsMultiSelect.es8.js"],"sourcesContent":["import $ from 'jquery'\r\nimport Popper from 'popper.js'\r\n\r\n// TODO: \r\n// 2) require polyfill Element.closest polyfill IE 11\r\n// 3) require multiple classList.add polyfill IE 11\r\n\r\n// IIFE to declare private members\r\nconst BsMultiSelect = ((window, $, Popper) => {\r\n    const JQUERY_NO_CONFLICT = $.fn[pluginName];\r\n    const pluginName = \"dashboardCodeBsMultiSelect\";\r\n    const dataKey = \"plugin_\" + pluginName;\r\n\r\n    const defFilterInputItemStyleSys = {\"display\": \"block\"};\r\n    const defSelectedPanelClass = \"form-control btn border\";\r\n    const defFilterInputStyle = {\"width\": \"2ch\", \"border\": \"0\", \"padding\": \"0\", \"outline\": \"none\"};\r\n    const defSelectedPanelStyle = {\"cursor\": \"text\", \"display\": \"flex\", \"flex-wrap\": \"wrap\", \"align-items\": \"center\", \"margin-bottom\": \"0px\"};\r\n    const defSelectedItemClass = \"badge\";\r\n    const defSelectedItemStyle = {\"padding-left\": \"0px\", \"display\": \"flex\", \"align-items\": \"center\"};\r\n    const defRemoveSelectedItemButtonClass = \"close\";\r\n    const defRemoveSelectedItemButtonStyle = {\"font-size\": \"100%\"};\r\n    const defaults = {\r\n        items: [],\r\n        defaults: [],\r\n        //usePopper: true,\r\n        selectedPanelMinHeight: \"calc(2.25rem + 2px)\",\r\n        selectedPanelReadonlyBackgroundColor: \"#e9ecef\",\r\n        selectedPanelValidBoxShadow: \" 0 0 0 0.2rem rgba(40, 167, 69, 0.25)\",\r\n        selectedPanelInvalidBoxShadow: \"0 0 0 0.2rem rgba(220, 53, 69, 0.25)\",\r\n        filterInputColor: \"#495057\",\r\n        containerClass: \"dashboardcode-bsmultiselect\",\r\n        dropDownMenuClass: \"dropdown-menu\",\r\n        dropDownItemClass: \"px-2\",\r\n        selectedPanelClass: \"\",\r\n        selectedPanelReadonlyClass: \"\",\r\n        selectedItemClass: \"\", \r\n        removeSelectedItemButtonClass: \"\",\r\n        filterInputItemClass: \"\", \r\n        filterInputClass: \"\"\r\n    };\r\n\r\n    class Plugin {\r\n        constructor(element, options) {\r\n            if (typeof Popper === 'undefined') {\r\n                throw new TypeError('DashboardCode bsMultiSelect require Popper.js (https://popper.js.org)')\r\n            }\r\n\r\n            // readonly\r\n            this.element = element;\r\n            this.options = $.extend({}, defaults, options);\r\n            this.input = element;\r\n            this.container = null;\r\n            this.dropDownMenu = null;\r\n            this.selectedPanel = null;\r\n            this.filterInput = null;\r\n            this.filterInputItem = null;\r\n            this.popper = null;\r\n\r\n            // state\r\n            this.skipFocusout = false;\r\n            this.backspaceAtStartPoint = null;\r\n            this.selectedDropDownItem = null;\r\n            this.selectedDropDownIndex = null;\r\n            this.hasItems = false;\r\n\r\n            this.init();\r\n        }\r\n\r\n        updateDropDownPosition() {\r\n            //console.log(\"updateDropDownPosition\");\r\n            //if (this.options.usePopper) {\r\n                this.popper.update();\r\n            // } else {\r\n            //     $(this.dropDownMenu).dropdown('update');\r\n            // }\r\n        }\r\n\r\n        hideDropDown() {\r\n            //if (this.options.usePopper) {\r\n                //console.log(\"popper remove show\");\r\n                $(this.dropDownMenu).removeClass('show')\r\n            // } else {\r\n            //     if ($(this.dropDownMenu).hasClass('show'))\r\n            //         $(this.dropDownMenu).dropdown('toggle');\r\n            // }\r\n        }\r\n\r\n        showDropDown() {\r\n            if (this.hasItems) {\r\n                //if (this.options.usePopper) {\r\n                    //console.log(\"popper add show\");\r\n                    $(this.dropDownMenu).addClass('show')\r\n                // } else {\r\n                //     if (!$(this.dropDownMenu).hasClass('show'))\r\n                //         $(this.dropDownMenu).dropdown('toggle');\r\n                // }\r\n            }\r\n        }\r\n\r\n        setCheck(optionId, isChecked) {\r\n            for (var i = 0; i < this.input.options.length; i += 1) {\r\n                var option = this.input.options[i];\r\n                if (option.value == optionId) {\r\n                    this.input.options[i].selected = isChecked;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Public methods\r\n        getInputValue() {\r\n            return $(this.input).val();\r\n        }\r\n\r\n        closeDropDown() {\r\n            this.clearFilterInput();\r\n            this.hideDropDown();\r\n            this.updateDropDownPosition();\r\n        }\r\n\r\n\r\n        clearFilterInput() {\r\n            if (this.filterInput.value != '') {\r\n                this.filterInput.value = '';\r\n                this.filterDropDownMenu();\r\n                if (this.hasItems) {\r\n                    this.updateDropDownPosition(); \r\n                } \r\n            }\r\n        }\r\n\r\n        filterDropDownMenu() {\r\n            var text = this.filterInput.value.trim();\r\n            var visible = 0;\r\n            $(this.dropDownMenu).find('li').each(function () {\r\n                var $item = $(this);\r\n                if (text == \"\") {\r\n                    $item.show();\r\n                    visible++;\r\n                }\r\n                else {\r\n                    var itemText = $item.text();\r\n                    var $checkbox = $item.find('input[type=\"checkbox\"]');\r\n                    \r\n                    if (!$checkbox.prop('checked') && itemText.toLowerCase().includes(text.toLowerCase())) {\r\n                        $item.show();\r\n                        visible++;\r\n                    } else {\r\n                        $item.hide();\r\n                    }\r\n                }\r\n            });\r\n            this.hasItems = (visible > 0);\r\n            this.resetSelectDropDownMenu();\r\n        }\r\n\r\n        clickDropDownItem(event) {\r\n            //console.log(\"filter & stopPropagation\");\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n            var menuItem = event.currentTarget.closest(\"LI\");\r\n            var $menuItem = $(menuItem);\r\n            var optionId = $menuItem.data(\"option-id\");\r\n            var $checkBox = $menuItem.find('input[type=\"checkbox\"]');\r\n            if ($checkBox.prop('checked')) {\r\n                var $selectedItem = $(this.selectedPanel).find(`li[data-option-id=\"${optionId}\"]`);\r\n                this.removeSelectedItem($selectedItem, optionId, $checkBox);\r\n            } else {\r\n                var itemText = $menuItem.find('label').text();\r\n                this.createAndAppendSelectedItem($checkBox, optionId, itemText);\r\n                $checkBox.prop('checked', true);\r\n            }\r\n            this.clearFilterInput();\r\n            $(this.filterInput).focus();\r\n        }\r\n\r\n        \r\n        appendDropDownItem(itemValue, itemText, isChecked) {\r\n            var optionId = itemValue;\r\n            var checkBoxId = `dashboardcode-bsmultiselect-${this.input.name.toLowerCase()}-generated-id-${optionId.toLowerCase()}`;\r\n            var checked = isChecked ? \"checked\" : \"\";\r\n            var $dropDownItem = $(\r\n                `<li data-option-id=\"${optionId}\">\r\n                    <div class=\"custom-control custom-checkbox\">\r\n                        <input type=\"checkbox\" class=\"custom-control-input\" id=\"${checkBoxId}\" ${checked}>\r\n                        <label class=\"custom-control-label\" for=\"${checkBoxId}\">${itemText}</label>\r\n                    </div>\r\n                 </li>`).addClass(this.options.dropDownItemClass).appendTo($(this.dropDownMenu));\r\n\r\n            var $checkBox = $dropDownItem.find(`input[type=\"checkbox\"]`);\r\n            if (isChecked) {\r\n                this.createAndAppendSelectedItem($checkBox, optionId, itemText);\r\n            }\r\n        }\r\n        \r\n        createAndAppendSelectedItem($checkBox, optionId, itemText) {\r\n            var $selectedItem = $(`<li data-option-id=\"${optionId}\"><span>${itemText}</span></li>`);\r\n            if (!this.options.selectedItemClass){\r\n                $selectedItem.addClass(defSelectedItemClass);\r\n                $selectedItem.css(defSelectedItemStyle)\r\n            }else{\r\n                $selectedItem.addClass(this.options.selectedItemClass);\r\n            }\r\n                \r\n            $selectedItem.insertBefore($(this.filterInputItem));\r\n            var $buttom = $(\"<button aria-label='Close' tabIndex='-1' type='button'><span aria-hidden='true'>&times;</span></button>\");\r\n            if (!this.options.removeSelectedItemButtonClass){\r\n                $buttom.addClass(defRemoveSelectedItemButtonClass);\r\n                $buttom.css(defRemoveSelectedItemButtonStyle);\r\n            }\r\n            else{\r\n                $buttom.addClass(this.options.removeSelectedItemButtonClass)\r\n            }\r\n            \r\n            $buttom.appendTo($selectedItem); \r\n            this.setCheck(optionId, true);\r\n\r\n            $buttom.click((event) => {\r\n                this.removeSelectedItem($selectedItem, optionId, $checkBox)\r\n                this.updateDropDownPosition();\r\n                $(this.filterInput).focus();\r\n            });\r\n        }\r\n\r\n        adoptFilterInputLength() {\r\n            this.filterInput.style.width = this.filterInput.value.length*1.3 + 2 + \"ch\";\r\n        }\r\n\r\n        analyzeInputText() {\r\n            var text = this.filterInput.value.trim().toLowerCase();\r\n            var item = [...this.dropDownMenu.querySelectorAll(\"LI\")]\r\n                .find(i => i.textContent.trim().toLowerCase() == text);\r\n            if (item != undefined) {\r\n                var $item = $(item);\r\n                var $checkBox = $item.find('input[type=\"checkbox\"]');\r\n                if (!$checkBox.prop('checked')) {\r\n                    var optionId = $item.data('option-id');\r\n                    var itemText = $item.find('label').text();\r\n                    this.createAndAppendSelectedItem($checkBox, optionId, itemText);\r\n                    $checkBox.prop('checked', true);\r\n\r\n                }\r\n                this.clearFilterInput();\r\n            }\r\n        }\r\n\r\n        resetSelectDropDownMenu() {\r\n            if (this.selectedDropDownItem != null) {\r\n                // IE11 doesn't support remove('text-primary', bg-light' )\r\n                this.selectedDropDownItem.classList.remove('bg-light');\r\n                this.selectedDropDownItem.classList.remove('text-primary');\r\n                this.selectedDropDownItem = null;\r\n            }\r\n            this.selectedDropDownIndex = null;\r\n        }\r\n        \r\n        keydownArrow(down) {\r\n            var items = [...this.dropDownMenu.querySelectorAll('LI:not([style*=\"display: none\"]')];\r\n            if (items.length > 0) {\r\n                this.showDropDown();\r\n                if (this.selectedDropDownItem == null) {\r\n                    \r\n                    this.selectedDropDownIndex = (down) ? 0 : items.length - 1;\r\n                }\r\n                else {\r\n                    // IE11 doesn't support remove('text-primary', bg-light' )\r\n                    this.selectedDropDownItem.classList.remove('bg-light');\r\n                    this.selectedDropDownItem.classList.remove('text-primary');\r\n                    if (down) {\r\n                        var newIndex = this.selectedDropDownIndex + 1;\r\n                        this.selectedDropDownIndex = (newIndex < items.length) ? newIndex : 0;\r\n                    } else {\r\n                        var newIndex = this.selectedDropDownIndex - 1;\r\n                        this.selectedDropDownIndex = (newIndex >= 0) ? newIndex : items.length - 1;\r\n                    }\r\n                }\r\n                this.selectedDropDownItem = items[this.selectedDropDownIndex];\r\n                // IE11 doesn't support add('text-primary', bg-light' )\r\n                this.selectedDropDownItem.classList.add('text-primary');\r\n                this.selectedDropDownItem.classList.add('bg-light' );\r\n                \r\n            }\r\n        }\r\n\r\n        removeSelectedItem($selectedItem, optionId, $checkBox) {\r\n            $selectedItem.remove();\r\n            this.setCheck(optionId, false);\r\n            $checkBox.prop('checked', false);\r\n        }\r\n\r\n        init() {\r\n            var $input = $(this.input);\r\n            $input.hide();\r\n            var disabled = this.input.disabled;\r\n\r\n            var $container = $(\"<div/>\");\r\n            if (!this.options.containerClass)\r\n                $container.addClass(this.options.containerClass);\r\n            $container.insertAfter($input);\r\n                \r\n            this.container = $container.get(0);\r\n\r\n            var $selectedPanel = $(\"<ul/>\");\r\n\r\n            if (!this.options.selectedPanelClass){\r\n                $selectedPanel.addClass(defSelectedPanelClass);\r\n                $selectedPanel.css(defSelectedPanelStyle);\r\n                $selectedPanel.css(\"min-height\",this.options.selectedPanelMinHeight);\r\n            }\r\n            else\r\n                $selectedPanel.addClass(this.options.selectedPanelClass);\r\n            $selectedPanel.appendTo($container);\r\n            this.selectedPanel = $selectedPanel.get(0);\r\n\r\n            if ($input.hasClass(\"is-valid\")){\r\n                $selectedPanel.removeClass(\"border\");\r\n                $selectedPanel.addClass(\"is-valid\");\r\n                //$selectedPanel.removeClass(\"btn-outline-danger\");\r\n                //$selectedPanel.addClass(\"btn-outline-success\");\r\n                \r\n            }\r\n            \r\n            if ($input.hasClass(\"is-invalid\")){\r\n                $selectedPanel.removeClass(\"border\");\r\n                $selectedPanel.addClass(\"is-invalid\");\r\n                //$selectedPanel.removeClass(\"btn-outline-success\");\r\n                //$selectedPanel.addClass(\"btn-outline-danger\");\r\n            }\r\n\r\n            var $filterInputItem = $('<li/>');\r\n            this.filterInputItem = $filterInputItem.get(0)\r\n            if (!this.options.filterInputItemClass)\r\n                $filterInputItem.css(defFilterInputItemStyleSys)\r\n            else\r\n                $filterInputItem.addClass(this.options.filterInputItemClass)\r\n            \r\n            $filterInputItem.appendTo($selectedPanel);\r\n            \r\n\r\n            var $filterInput = $('<input type=\"search\" autocomplete=\"off\">');\r\n            if (!this.options.filterInputClass){\r\n                $filterInput.css(defFilterInputStyle);\r\n                $filterInput.css(\"color\", this.options.filterInputColor);\r\n            } else {\r\n                $filterInput.addClass(this.options.filterInputClass);\r\n            }\r\n            $filterInput.appendTo($filterInputItem);\r\n            this.filterInput = $filterInput.get(0)\r\n\r\n            var $dropDownMenu = $(\"<ul/>\").appendTo($container);\r\n            this.dropDownMenu = $dropDownMenu.get(0);\r\n\r\n            $dropDownMenu.addClass(this.options.dropDownMenuClass);\r\n            //if (this.options.usePopper) {\r\n                this.popper = new Popper(this.filterInput, this.dropDownMenu, {\r\n                    placement: 'bottom-start',\r\n                    modifiers: {\r\n                        flip: {\r\n                            behavior: ['left', 'right']\r\n                        },\r\n                    },\r\n                });\r\n            // } else {\r\n            //     $(this.dropDownMenu).addClass(\"dropdown dropdown-menu\")\r\n            //     $(this.dropDownMenu).data(\"\", \"\");\r\n            //     $(this.dropDownMenu).dropdown({\r\n            //         placement: 'bottom-start',\r\n            //         flip: false,\r\n            //         reference: this.filterInput\r\n            //     });\r\n            // }\r\n\r\n            if (this.options.items == null) {\r\n                this.options.items.forEach(item => {\r\n                    var itemValue = item['value'];\r\n                    var itemText = item['text'];\r\n                    var isChecked = item['isChecked'];\r\n                    this.appendDropDownItem(itemValue, itemText, isChecked);\r\n                });\r\n                this.hasItems = options.items.length > 0;\r\n            } else {\r\n                var selectOptions = $input.find('option');\r\n                selectOptions.each(\r\n                    (index, option) => {\r\n                        var itemValue = option.value;\r\n                        var itemText = option.text;\r\n                        var isChecked = option.selected;\r\n                        this.appendDropDownItem(itemValue, itemText, isChecked);\r\n                    }\r\n                );\r\n                this.hasItems = selectOptions.length > 0;\r\n            }\r\n            if (disabled) {\r\n                this.filterInput.style.display = \"none\";\r\n                if(!this.options.selectedPanelReadonlyClass){\r\n                    $selectedPanel.css({\"background-color\": this.options.selectedPanelReadonlyBackgroundColor});\r\n                }else{\r\n                    $selectedPanel.addClass(this.options.selectedPanelReadonlyClass);\r\n                }\r\n                $selectedPanel.find('button').prop(\"disabled\", true);\r\n                $selectedPanel.addClass();\r\n            } else {\r\n                var inputId = this.input.id;\r\n                var formGroup = this.input.closest(\".form-group\");\r\n                if (formGroup != null) {\r\n                    var label = formGroup.querySelector(`label[for=\"${inputId}\"]`);\r\n                    var f = $(label).attr(\"for\");\r\n                    if ( f == this.input.id) {\r\n                        this.filterInput.id = \"dashboardcode-bsmultiselect-generated-filter-id-\" + this.input.id;\r\n                        label.setAttribute(\"for\", this.filterInput.id);\r\n                    }\r\n                }\r\n\r\n                this.updateDropDownPosition();\r\n\r\n                $dropDownMenu.click(event => {\r\n                    //console.log('dropDownMenu click - stopPropagation')\r\n                    event.stopPropagation();\r\n                });\r\n\r\n                $dropDownMenu.find('li').click((event) => {\r\n                    this.clickDropDownItem(event);\r\n                });\r\n\r\n                $dropDownMenu.on(\"mouseover\", (event) => {\r\n                    this.resetSelectDropDownMenu();\r\n                });\r\n\r\n                $dropDownMenu.find(\"li\").on(\"mouseover\", (event) => {\r\n                    event.target.closest(\"li\").classList.add('text-primary');\r\n                    event.target.closest(\"li\").classList.add('bg-light');\r\n                });\r\n\r\n                $dropDownMenu.find(\"li\").on(\"mouseout\", (event) => {\r\n                    event.target.closest(\"li\").classList.remove('text-primary');\r\n                    event.target.closest(\"li\").classList.remove('bg-light');\r\n                });\r\n\r\n                $selectedPanel.click((event) => {\r\n                    //console.log('selectedPanel click ' + event.target.nodeName);\r\n                    if (event.target.nodeName != \"INPUT\")\r\n                        $(this.filterInput).val('').focus();\r\n                    if (!(event.target.nodeName == \"BUTTON\" || (event.target.nodeName == \"SPAN\" && event.target.parentElement.nodeName == \"BUTTON\")))\r\n                        this.showDropDown();\r\n                });\r\n\r\n\r\n                $filterInput.on(\"keydown\", (event) => {\r\n                    if (event.which == 38 || event.keyCode == 38) {\r\n                        event.preventDefault();\r\n                        this.keydownArrow(false);\r\n                    }\r\n                    else if (event.which == 40 || event.keyCode == 40) {\r\n                        event.preventDefault()\r\n                        this.keydownArrow(true);\r\n                    }\r\n                    else if (event.which == 13 || event.keyCode == 13) {\r\n                        event.preventDefault();\r\n                    }\r\n                    else if (event.which == 9 || event.keyCode == 9){\r\n                        if (this.filterInput.value){\r\n                            event.preventDefault();\r\n                        }else{\r\n                            this.closeDropDown();\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (event.which == 8 || event.keyCode == 8) {\r\n                            // detect that backspace is at start of input field (this will be used at keydown)\r\n                            this.backspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n                        }\r\n                        this.resetSelectDropDownMenu();\r\n                    }\r\n                });\r\n\r\n                $filterInput.on(\"keyup\", (event) => {\r\n                    if (event.which == 13 || event.keyCode == 13 || event.which == 9 || event.keyCode == 9) {\r\n                        if (this.selectedDropDownItem != null) {\r\n                            var $item = $(this.selectedDropDownItem);\r\n                            var $checkBox = $item.find('input[type=\"checkbox\"]');\r\n                            var optionId = $item.data('option-id');\r\n                            if (!$checkBox.prop('checked')) {\r\n                                var itemText = $item.find('label').text();\r\n                                this.createAndAppendSelectedItem($checkBox, optionId, itemText);\r\n                                $checkBox.prop('checked', true);\r\n                                this.filterInput.value = \"\";\r\n                            } else {\r\n                                var $selectedItem = $(this.selectedPanel).find(`li[data-option-id=\"${optionId}\"]`);\r\n                                this.removeSelectedItem($selectedItem, optionId, $checkBox);\r\n                            }\r\n                            //this.resetSelectDropDownMenu();\r\n                        } else {\r\n                            this.analyzeInputText();\r\n                        }\r\n                        if (event.which == 9 || event.keyCode == 9){\r\n                            this.closeDropDown();\r\n\r\n                        }\r\n                    } else if (event.which == 8 || event.keyCode == 8) {\r\n                        var startPosition = this.filterInput.selectionStart;\r\n                        var endPosition = this.filterInput.selectionEnd;\r\n                        if (endPosition == 0 && startPosition == 0 && this.backspaceAtStartPoint) {\r\n                            var array = [...this.selectedPanel.querySelectorAll(\"LI\")];\r\n                            if (array.length >= 2) {\r\n                                var itemToDelete = array[array.length - 2];\r\n                                var $itemToDelete = $(itemToDelete);\r\n                                var optionId = $itemToDelete.data(\"option-id\");\r\n                                var item = [...this.dropDownMenu.querySelectorAll(\"LI\")]\r\n                                    .find(i => i.dataset.optionId == optionId);\r\n                                var $item = $(item);\r\n                                var $checkBox = $item.find('input[type=\"checkbox\"]');\r\n                                var $selectedItem = $(this.selectedPanel).find(`li[data-option-id=\"${optionId}\"]`);\r\n                                this.removeSelectedItem($selectedItem, optionId, $checkBox);\r\n                            }\r\n                        }\r\n                        this.backspaceAtStartPoint = null;\r\n                    } else if (event.which == 27 || event.keyCode == 27) { // escape\r\n                        this.closeDropDown();\r\n                    }\r\n\r\n                });\r\n\r\n                // Set on change for filter input\r\n                $filterInput.on('input', (event) => { // keyup focus\r\n                    //console.log('filterInput input');\r\n                    this.adoptFilterInputLength();\r\n                    this.filterDropDownMenu();\r\n                    if (this.hasItems) {\r\n                        this.updateDropDownPosition(); // support case when textbox can change its place because of line break (texbox grow with each key press)\r\n                        this.showDropDown();\r\n                    } else {\r\n                        this.hideDropDown();\r\n                    }\r\n                });\r\n\r\n                $filterInput.focusin((event) => {\r\n                    if( $selectedPanel.hasClass(\"is-valid\") &&  this.options.selectedPanelValidBoxShadow ){\r\n                        $selectedPanel.css(\"box-shadow\", this.options.selectedPanelValidBoxShadow );              \r\n                    }else if ( $selectedPanel.hasClass(\"is-invalid\") && this.options.selectedPanelInvalidBoxShadow){\r\n                        $selectedPanel.css(\"box-shadow\", this.options.selectedPanelInvalidBoxShadow );\r\n                    }\r\n                    $(this.selectedPanel).addClass(\"focus\");\r\n                });\r\n\r\n                $filterInput.focusout((event) => {\r\n                    if (!this.skipFocusout)\r\n                    {\r\n                        $selectedPanel.css(\"box-shadow\", \"\" );                \r\n                        $(this.selectedPanel).removeClass(\"focus\");\r\n                    }\r\n                });\r\n\r\n                $container.mousedown((event) => {\r\n                    this.skipFocusout = true;\r\n\r\n                });\r\n\r\n                $(window.document).mouseup((event) => {\r\n                    this.skipFocusout = false;\r\n                    if (!(this.container === event.target || this.container.contains(event.target))) {\r\n                        //console.log(\"document mouseup outside container\");\r\n                        this.closeDropDown();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    var jQueryInterface = function (options) {\r\n        return this.each(function () {\r\n            let data = $(this).data(dataKey)\r\n\r\n            if (!data) {\r\n                if (/dispose|hide/.test(options)) {\r\n                    return;\r\n                }\r\n                else {\r\n                    const optionsObject = (typeof options === 'object')? options:null;\r\n                    data = new Plugin(this, optionsObject);\r\n                    $(this).data(dataKey, data);\r\n                }\r\n            }\r\n\r\n            if (typeof options === 'string') {\r\n                var methodName = options;\r\n                if (typeof data[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named \"${methodName}\"`)\r\n                }\r\n                data[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[pluginName] = jQueryInterface;\r\n\r\n    // in case of mulitple $(this) it will return 1st element plugin instance\r\n    $.fn[pluginName.charAt(0).toUpperCase() + pluginName.slice(1)] = function (options) {\r\n        return $(this).data(\"plugin_\" + pluginName);\r\n    };\r\n\r\n    $.fn[pluginName].Constructor = Plugin;\r\n\r\n    $.fn[pluginName].noConflict = function () {\r\n        $.fn[pluginName] = JQUERY_NO_CONFLICT\r\n        return jQueryInterface;\r\n    }\r\n    return Plugin;\r\n})(window, $, Popper);\r\n\r\nexport default BsMultiSelect;\r\n"],"names":["BsMultiSelect","window","$","Popper","JQUERY_NO_CONFLICT","fn","pluginName","dataKey","defFilterInputItemStyleSys","defSelectedPanelClass","defFilterInputStyle","defSelectedPanelStyle","defSelectedItemClass","defSelectedItemStyle","defRemoveSelectedItemButtonClass","defRemoveSelectedItemButtonStyle","defaults","items","selectedPanelMinHeight","selectedPanelReadonlyBackgroundColor","selectedPanelValidBoxShadow","selectedPanelInvalidBoxShadow","filterInputColor","containerClass","dropDownMenuClass","dropDownItemClass","selectedPanelClass","selectedPanelReadonlyClass","selectedItemClass","removeSelectedItemButtonClass","filterInputItemClass","filterInputClass","Plugin","element","options","TypeError","extend","input","container","dropDownMenu","selectedPanel","filterInput","filterInputItem","popper","skipFocusout","backspaceAtStartPoint","selectedDropDownItem","selectedDropDownIndex","hasItems","init","update","removeClass","addClass","optionId","isChecked","i","length","option","value","selected","val","clearFilterInput","hideDropDown","updateDropDownPosition","filterDropDownMenu","text","trim","visible","find","each","$item","show","itemText","$checkbox","prop","toLowerCase","includes","hide","resetSelectDropDownMenu","event","preventDefault","stopPropagation","menuItem","currentTarget","closest","$menuItem","data","$checkBox","$selectedItem","removeSelectedItem","createAndAppendSelectedItem","focus","itemValue","checkBoxId","name","checked","$dropDownItem","appendTo","css","insertBefore","$buttom","setCheck","click","style","width","item","querySelectorAll","textContent","undefined","classList","remove","down","showDropDown","newIndex","add","$input","disabled","$container","insertAfter","get","$selectedPanel","hasClass","$filterInputItem","$filterInput","$dropDownMenu","placement","modifiers","flip","behavior","forEach","appendDropDownItem","selectOptions","index","display","inputId","id","formGroup","label","querySelector","f","attr","setAttribute","clickDropDownItem","on","target","nodeName","parentElement","which","keyCode","keydownArrow","closeDropDown","selectionStart","selectionEnd","analyzeInputText","startPosition","endPosition","array","itemToDelete","$itemToDelete","dataset","adoptFilterInputLength","focusin","focusout","mousedown","document","mouseup","contains","jQueryInterface","test","optionsObject","methodName","charAt","toUpperCase","slice","Constructor","noConflict"],"mappings":"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"}