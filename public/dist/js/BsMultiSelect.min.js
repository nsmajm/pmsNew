/*!
  * DashboardCode BsMultiSelect v0.1.0 (https://dashboardcode.github.io/BsMultiSelect/)
  * Copyright 2017-2018 Roman Pokrovskij (github user rpokrovskij)
  * Licensed under APACHE 2 (https://github.com/DashboardCode/BsMultiSelect/blob/master/LICENSE)
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("popper.js")):"function"==typeof define&&define.amd?define(["jquery","popper.js"],t):e.BsMultiSelect=t(e.jQuery,e.Popper)}(this,function(e,t){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var h,f,m,o,n,l,w,D,I,a,r,c,d,p;return e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,h=window,m=t,o=(f=e).fn[n],l="plugin_"+(n="dashboardCodeBsMultiSelect"),w={display:"block"},D={width:"2ch",border:"0",padding:"0",outline:"none"},I={cursor:"text",display:"flex","flex-wrap":"wrap","align-items":"center","margin-bottom":"0px"},a={"padding-left":"0px",display:"flex","align-items":"center"},r={"font-size":"100%"},c={items:[],defaults:[],selectedPanelMinHeight:"calc(2.25rem + 2px)",selectedPanelReadonlyBackgroundColor:"#e9ecef",selectedPanelValidBoxShadow:" 0 0 0 0.2rem rgba(40, 167, 69, 0.25)",selectedPanelInvalidBoxShadow:"0 0 0 0.2rem rgba(220, 53, 69, 0.25)",filterInputColor:"#495057",containerClass:"dashboardcode-bsmultiselect",dropDownMenuClass:"dropdown-menu",dropDownItemClass:"px-2",selectedPanelClass:"",selectedPanelReadonlyClass:"",selectedItemClass:"",removeSelectedItemButtonClass:"",filterInputItemClass:"",filterInputClass:""},d=function(){function o(e,t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),"undefined"==typeof m)throw new TypeError("DashboardCode bsMultiSelect require Popper.js (https://popper.js.org)");this.element=e,this.options=f.extend({},c,t),this.input=e,this.container=null,this.dropDownMenu=null,this.selectedPanel=null,this.filterInput=null,this.filterInputItem=null,this.popper=null,this.skipFocusout=!1,this.backspaceAtStartPoint=null,this.selectedDropDownItem=null,this.selectedDropDownIndex=null,this.hasItems=!1,this.init()}var e,t,n;return e=o,(t=[{key:"updateDropDownPosition",value:function(){this.popper.update()}},{key:"hideDropDown",value:function(){f(this.dropDownMenu).removeClass("show")}},{key:"showDropDown",value:function(){this.hasItems&&f(this.dropDownMenu).addClass("show")}},{key:"setCheck",value:function(e,t){for(var o=0;o<this.input.options.length;o+=1){if(this.input.options[o].value==e){this.input.options[o].selected=t;break}}}},{key:"getInputValue",value:function(){return f(this.input).val()}},{key:"closeDropDown",value:function(){this.clearFilterInput(),this.hideDropDown(),this.updateDropDownPosition()}},{key:"clearFilterInput",value:function(){""!=this.filterInput.value&&(this.filterInput.value="",this.filterDropDownMenu(),this.hasItems&&this.updateDropDownPosition())}},{key:"filterDropDownMenu",value:function(){var o=this.filterInput.value.trim(),n=0;f(this.dropDownMenu).find("li").each(function(){var e=f(this);if(""==o)e.show(),n++;else{var t=e.text();!e.find('input[type="checkbox"]').prop("checked")&&t.toLowerCase().includes(o.toLowerCase())?(e.show(),n++):e.hide()}}),this.hasItems=0<n,this.resetSelectDropDownMenu()}},{key:"clickDropDownItem",value:function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.closest("LI"),o=f(t),n=o.data("option-id"),s=o.find('input[type="checkbox"]');if(s.prop("checked")){var i=f(this.selectedPanel).find('li[data-option-id="'.concat(n,'"]'));this.removeSelectedItem(i,n,s)}else{var l=o.find("label").text();this.createAndAppendSelectedItem(s,n,l),s.prop("checked",!0)}this.clearFilterInput(),f(this.filterInput).focus()}},{key:"appendDropDownItem",value:function(e,t,o){var n=e,s="dashboardcode-bsmultiselect-".concat(this.input.name.toLowerCase(),"-generated-id-").concat(n.toLowerCase()),i=o?"checked":"",l=f('<li data-option-id="'.concat(n,'">\n                    <div class="custom-control custom-checkbox">\n                        <input type="checkbox" class="custom-control-input" id="').concat(s,'" ').concat(i,'>\n                        <label class="custom-control-label" for="').concat(s,'">').concat(t,"</label>\n                    </div>\n                 </li>")).addClass(this.options.dropDownItemClass).appendTo(f(this.dropDownMenu)).find('input[type="checkbox"]');o&&this.createAndAppendSelectedItem(l,n,t)}},{key:"createAndAppendSelectedItem",value:function(t,o,e){var n=this,s=f('<li data-option-id="'.concat(o,'"><span>').concat(e,"</span></li>"));this.options.selectedItemClass?s.addClass(this.options.selectedItemClass):(s.addClass("badge"),s.css(a)),s.insertBefore(f(this.filterInputItem));var i=f("<button aria-label='Close' tabIndex='-1' type='button'><span aria-hidden='true'>&times;</span></button>");this.options.removeSelectedItemButtonClass?i.addClass(this.options.removeSelectedItemButtonClass):(i.addClass("close"),i.css(r)),i.appendTo(s),this.setCheck(o,!0),i.click(function(e){n.removeSelectedItem(s,o,t),n.updateDropDownPosition(),f(n.filterInput).focus()})}},{key:"adoptFilterInputLength",value:function(){this.filterInput.style.width=1.3*this.filterInput.value.length+2+"ch"}},{key:"analyzeInputText",value:function(){var t=this.filterInput.value.trim().toLowerCase(),e=u(this.dropDownMenu.querySelectorAll("LI")).find(function(e){return e.textContent.trim().toLowerCase()==t});if(null!=e){var o=f(e),n=o.find('input[type="checkbox"]');if(!n.prop("checked")){var s=o.data("option-id"),i=o.find("label").text();this.createAndAppendSelectedItem(n,s,i),n.prop("checked",!0)}this.clearFilterInput()}}},{key:"resetSelectDropDownMenu",value:function(){null!=this.selectedDropDownItem&&(this.selectedDropDownItem.classList.remove("bg-light"),this.selectedDropDownItem.classList.remove("text-primary"),this.selectedDropDownItem=null),this.selectedDropDownIndex=null}},{key:"keydownArrow",value:function(e){var t=u(this.dropDownMenu.querySelectorAll('LI:not([style*="display: none"]'));if(0<t.length){if(this.showDropDown(),null==this.selectedDropDownItem)this.selectedDropDownIndex=e?0:t.length-1;else if(this.selectedDropDownItem.classList.remove("bg-light"),this.selectedDropDownItem.classList.remove("text-primary"),e){var o=this.selectedDropDownIndex+1;this.selectedDropDownIndex=o<t.length?o:0}else{o=this.selectedDropDownIndex-1;this.selectedDropDownIndex=0<=o?o:t.length-1}this.selectedDropDownItem=t[this.selectedDropDownIndex],this.selectedDropDownItem.classList.add("text-primary"),this.selectedDropDownItem.classList.add("bg-light")}}},{key:"removeSelectedItem",value:function(e,t,o){e.remove(),this.setCheck(t,!1),o.prop("checked",!1)}},{key:"init",value:function(){var d=this,e=f(this.input);e.hide();var t=this.input.disabled,o=f("<div/>");this.options.containerClass||o.addClass(this.options.containerClass),o.insertAfter(e),this.container=o.get(0);var n=f("<ul/>");this.options.selectedPanelClass?n.addClass(this.options.selectedPanelClass):(n.addClass("form-control btn border"),n.css(I),n.css("min-height",this.options.selectedPanelMinHeight)),n.appendTo(o),this.selectedPanel=n.get(0),e.hasClass("is-valid")&&(n.removeClass("border"),n.addClass("is-valid")),e.hasClass("is-invalid")&&(n.removeClass("border"),n.addClass("is-invalid"));var s=f("<li/>");this.filterInputItem=s.get(0),this.options.filterInputItemClass?s.addClass(this.options.filterInputItemClass):s.css(w),s.appendTo(n);var i=f('<input type="search" autocomplete="off">');this.options.filterInputClass?i.addClass(this.options.filterInputClass):(i.css(D),i.css("color",this.options.filterInputColor)),i.appendTo(s),this.filterInput=i.get(0);var l=f("<ul/>").appendTo(o);if(this.dropDownMenu=l.get(0),l.addClass(this.options.dropDownMenuClass),this.popper=new m(this.filterInput,this.dropDownMenu,{placement:"bottom-start",modifiers:{flip:{behavior:["left","right"]}}}),null==this.options.items)this.options.items.forEach(function(e){var t=e.value,o=e.text,n=e.isChecked;d.appendDropDownItem(t,o,n)}),this.hasItems=0<options.items.length;else{var a=e.find("option");a.each(function(e,t){var o=t.value,n=t.text,s=t.selected;d.appendDropDownItem(o,n,s)}),this.hasItems=0<a.length}if(t)this.filterInput.style.display="none",this.options.selectedPanelReadonlyClass?n.addClass(this.options.selectedPanelReadonlyClass):n.css({"background-color":this.options.selectedPanelReadonlyBackgroundColor}),n.find("button").prop("disabled",!0),n.addClass();else{var r=this.input.id,c=this.input.closest(".form-group");if(null!=c){var p=c.querySelector('label[for="'.concat(r,'"]'));f(p).attr("for")==this.input.id&&(this.filterInput.id="dashboardcode-bsmultiselect-generated-filter-id-"+this.input.id,p.setAttribute("for",this.filterInput.id))}this.updateDropDownPosition(),l.click(function(e){e.stopPropagation()}),l.find("li").click(function(e){d.clickDropDownItem(e)}),l.on("mouseover",function(e){d.resetSelectDropDownMenu()}),l.find("li").on("mouseover",function(e){e.target.closest("li").classList.add("text-primary"),e.target.closest("li").classList.add("bg-light")}),l.find("li").on("mouseout",function(e){e.target.closest("li").classList.remove("text-primary"),e.target.closest("li").classList.remove("bg-light")}),n.click(function(e){"INPUT"!=e.target.nodeName&&f(d.filterInput).val("").focus(),"BUTTON"==e.target.nodeName||"SPAN"==e.target.nodeName&&"BUTTON"==e.target.parentElement.nodeName||d.showDropDown()}),i.on("keydown",function(e){38==e.which||38==e.keyCode?(e.preventDefault(),d.keydownArrow(!1)):40==e.which||40==e.keyCode?(e.preventDefault(),d.keydownArrow(!0)):13==e.which||13==e.keyCode?e.preventDefault():9==e.which||9==e.keyCode?d.filterInput&&e.preventDefault():(8!=e.which&&8!=e.keyCode||(d.backspaceAtStartPoint=0==d.filterInput.selectionStart&&0==d.filterInput.selectionEnd),d.resetSelectDropDownMenu())}),i.on("keyup",function(e){if(13==e.which||13==e.keyCode||9==e.which||9==e.keyCode){if(null!=d.selectedDropDownItem){var t=(a=f(d.selectedDropDownItem)).find('input[type="checkbox"]'),o=a.data("option-id");if(t.prop("checked")){var n=f(d.selectedPanel).find('li[data-option-id="'.concat(o,'"]'));d.removeSelectedItem(n,o,t)}else{var s=a.find("label").text();d.createAndAppendSelectedItem(t,o,s),t.prop("checked",!0),d.filterInput.value=""}}else d.analyzeInputText();9!=e.which&&9!=e.keyCode||d.closeDropDown()}else if(8==e.which||8==e.keyCode){var i=d.filterInput.selectionStart;if(0==d.filterInput.selectionEnd&&0==i&&d.backspaceAtStartPoint){var l=u(d.selectedPanel.querySelectorAll("LI"));if(2<=l.length){var a,r=l[l.length-2],c=(o=f(r).data("option-id"),u(d.dropDownMenu.querySelectorAll("LI")).find(function(e){return e.dataset.optionId==o}));t=(a=f(c)).find('input[type="checkbox"]'),n=f(d.selectedPanel).find('li[data-option-id="'.concat(o,'"]'));d.removeSelectedItem(n,o,t)}}d.backspaceAtStartPoint=null}else 27!=e.which&&27!=e.keyCode||d.closeDropDown()}),i.on("input",function(e){d.adoptFilterInputLength(),d.filterDropDownMenu(),d.hasItems?(d.updateDropDownPosition(),d.showDropDown()):d.hideDropDown()}),i.focusin(function(e){n.hasClass("is-valid")&&d.options.selectedPanelValidBoxShadow?n.css("box-shadow",d.options.selectedPanelValidBoxShadow):n.hasClass("is-invalid")&&d.options.selectedPanelInvalidBoxShadow&&n.css("box-shadow",d.options.selectedPanelInvalidBoxShadow),f(d.selectedPanel).addClass("focus")}),i.focusout(function(e){d.skipFocusout||(n.css("box-shadow",""),f(d.selectedPanel).removeClass("focus"))}),o.mousedown(function(e){d.skipFocusout=!0}),f(h.document).mouseup(function(e){d.skipFocusout=!1,d.container===e.target||d.container.contains(e.target)||d.closeDropDown()})}}}])&&i(e.prototype,t),n&&i(e,n),o}(),p=function(n){return this.each(function(){var e=f(this).data(l);if(!e){if(/dispose|hide/.test(n))return;var t="object"===s(n)?n:null;e=new d(this,t),f(this).data(l,e)}if("string"==typeof n){var o=n;if("undefined"==typeof e[o])throw new TypeError('No method named "'.concat(o,'"'));e[o]()}})},f.fn[n]=p,f.fn[n.charAt(0).toUpperCase()+n.slice(1)]=function(e){return f(this).data("plugin_"+n)},f.fn[n].Constructor=d,f.fn[n].noConflict=function(){return f.fn[n]=o,p},d});
//# sourceMappingURL=BsMultiSelect.min.js.map